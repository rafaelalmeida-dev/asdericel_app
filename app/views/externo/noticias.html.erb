<section class="py-5" style="background-color: #f8f9fa;">
  <div class="container">
    <!-- Título -->
    <div class="text-center mb-5">
      <h1 class="display-4 fw-bold" style="color: #1a3a7d;">Notícias</h1>
      <p class="lead text-muted">Fique por dentro das últimas novidades da Asdericel</p>
    </div>

    <!-- Filtros por Categoria -->
    <div class="mb-4">
      <div class="d-flex flex-wrap gap-2 justify-content-center">
        <%= link_to "TODAS", noticias_publico_path, class: "btn #{params[:categoria].blank? ? 'btn-primary' : 'btn-outline-primary'}" %>
        <% Noticia::CATEGORIAS.each do |categoria| %>
          <%= link_to categoria, noticias_publico_path(categoria: categoria), class: "btn #{params[:categoria] == categoria ? 'btn-primary' : 'btn-outline-primary'}" %>
        <% end %>
      </div>
    </div>

    <!-- Grid de Notícias -->
    <% if @noticias.any? %>
      <div class="row g-4">
        <% @noticias.each do |noticia| %>
          <div class="col-md-6 col-lg-4">
            <%= link_to noticia_publico_path(noticia), class: "text-decoration-none" do %>
              <div class="card h-100 border-0 shadow-sm hover-news">
                <!-- Imagem -->
                <div class="position-relative overflow-hidden" style="height: 200px;">
                  <% imagem_src = noticia.imagem_upload.attached? ? noticia.imagem_upload : (noticia.imagem.presence || "2001.png") %>
                  <%= image_tag imagem_src, class: "w-100 h-100", style: "object-fit: cover;", alt: noticia.titulo %>
                  <span class="badge position-absolute top-0 end-0 m-3" style="background-color: <%= categoria_cor(noticia.categoria) %>;">
                    <%= noticia.categoria %>
                  </span>
                </div>

                <!-- Conteúdo -->
                <div class="card-body">
                  <h5 class="card-title fw-bold mb-2" style="color: #1a3a7d;">
                    <%= truncate(noticia.titulo, length: 80) %>
                  </h5>
                  <p class="card-text text-muted small mb-3">
                    <%= truncate(noticia.conteudo, length: 120) %>
                  </p>
                  <div class="d-flex justify-content-between align-items-center">
                    <small class="text-muted">
                      <i class="ph ph-calendar me-1"></i>
                      <%= l(noticia.data_publicacao, format: :short) %>
                    </small>
                    <span class="text-primary fw-bold small">
                      Ler mais <i class="ph ph-arrow-right"></i>
                    </span>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>

      <!-- Paginação -->
      <div class="mt-5 d-flex justify-content-center">
        <%= pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
      </div>
    <% else %>
      <!-- Mensagem quando não há notícias -->
      <div class="text-center py-5">
        <i class="ph ph-newspaper" style="font-size: 4rem; color: #d1d5db;"></i>
        <h4 class="mt-3 text-muted">Nenhuma notícia encontrada</h4>
        <p class="text-muted">Tente selecionar outra categoria</p>
      </div>
    <% end %>
  </div>
</section>

<style>
  .hover-news {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
  }
  
  .hover-news:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15) !important;
  }
</style>
